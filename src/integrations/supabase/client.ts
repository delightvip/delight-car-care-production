
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const SUPABASE_URL = "https://gmtzeqwyybgcjmkqhshr.supabase.co";
const SUPABASE_PUBLISHABLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdtdHplcXd5eWJnY2pta3Foc2hyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2NzkzOTksImV4cCI6MjA1ODI1NTM5OX0.USzf9MqbkRC9TAkuIbTjnjEZlRtRQMfDt4EPbi3aYXA";

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

// Add a client-side helper method for coalesce_numeric
supabase.rpc = function(name: string, params?: { [key: string]: any }) {
  if (name === 'coalesce_numeric' && params?.value) {
    // For client-side usage, we need to work around the issue by using a different approach
    // This is a placeholder for the query - the actual coalesce will happen server-side
    // When using lt('quantity', 'min_stock'), we'll return a placeholder
    return params.value;
  }
  
  // Default RPC behavior
  return {
    name,
    params
  };
};

// Define custom RPC function types to workaround type issues
export const rpcFunctions = {
  async getProductionStats() {
    return await supabase.functions.invoke('get_production_stats') as unknown as { 
      data: { 
        total_production_orders: number;
        completed_orders: number;
        pending_orders: number;
        total_cost: number;
      } | null;
      error: any;
    };
  },
  async getMonthlyProductionStats() {
    return await supabase.functions.invoke('get_monthly_production_stats') as unknown as {
      data: { 
        month: string;
        production_count: number;
        packaging_count: number;
      }[] | null;
      error: any;
    };
  }
};
